#:kivy 2.0

BoxLayout:
    BoxLayout:
        size_hint_x: 1/3
        orientation: 'vertical'
        BoxLayout:  # menu buttons group
            size_hint_y: 0.1
            width: self.width
            padding: dp(5)
            spacing: dp(5)
            AppButton:
                id: menu
                text: 'Menu'
                on_press: app.on_menu()
            AppButton:
                id: test
                text: "Test"
                on_press: app._test()
            AppButton:
                id: help
                pos_hint: {'right': 1, 'x': 1}
                text: "?"
                on_press: app.on_help()
        HSeparator:
        AppLabel:
            id: info
            size_hint_y: 0.72
            border_width: dp(3)
            border_color: app.DARK_COLOR
            text: "Puzzle instructions"
        TerminalLabel:
            id: terminal
            size_hint_y: 0.18
            #text: f"Terminal output...\nline 2...\nline 3...\nline 4...\nline 5...\nline 6..."
            max_lines: 6
    VSeparator:
    RelativeLayout:
        id: layout
        size_hint_x: 2/3


<ThemedButton@Button>:
    background_normal: ''  # sets initial background to white
    background_color: (1, 1, 1, 0)  # makes it transparent
    size_hint_y: 1
    size_hint_max_y: dp(50)
    color: app.DARK_COLOR
    bold: True
    canvas.before:
        Color:
            rgba: app.LIGHT_COLOR if self.state == 'normal' else app.LIGHTEST_COLOR
        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [dp(10)]

<AppButton@ThemedButton>:
    size_hint_x: None
    width: self.height


<ThemedLabel@Label>:
    padding: dp(10)
    canvas.before:
        Color:
            rgba: app.LIGHTER_COLOR
        Rectangle:
            pos: self.pos
            size: self.size
    color: app.DARK_COLOR
    halign: 'left'
    valign: 'top'
    font_size: sp(16)

<AppLabel@ThemedLabel>:
    text_size: self.size

<TerminalLabel@AppLabel>:
    canvas.before:
        Color:
            rgba: app.LIGHTEST_COLOR
        Rectangle:
            pos: self.pos
            size: self.size
    color: app.DARK_COLOR
    font_name: 'RobotoMono-Regular'
    valign: 'bottom'
    font_size: sp(12)


<Separator@Widget>:
    canvas:
        Color:
            rgba: app.DARK_COLOR
        Rectangle:
            pos: self.pos
            size: self.size

<HSeparator@Separator>:
    size_hint_y: None
    height: dp(1)

<VSeparator@Separator>:
    size_hint_x: None
    width: dp(1)


<ExceptionPopup>:
    title: "Error"
    title_size: dp(18)
    size_hint: (1/2, 3/4)
    BoxLayout:
        orientation: 'vertical'
        spacing: dp(10)
        ScrollView:
            size_hint_y: 0.8
            do_scroll_x: False
            do_scroll_y: True
            ThemedLabel:
                id: message
                padding: dp(3)
                size_hint_y: None
                height: self.texture_size[1]
                font_name: 'RobotoMono-Regular'
                font_size: dp(12)
                text_size: (self.width, None)
                size: self.texture_size
        ThemedButton:
            pos_hint: {"center_x": 0.5}
            size_hint_x: None
            size_hint_max_x: None
            size_hint_y: 0.2
            font_size: dp(18)
            text: "Quit"
            on_release: app.stop()